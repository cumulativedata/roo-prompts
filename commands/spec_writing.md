# Specification for Writing Specification Documents

## Purpose

This document provides explicit instructions for you, an AI agent, on how to create a clear and effective specification document. Your primary goal is to generate a specification that is sufficiently detailed and unambiguous to serve as the direct input for creating a technical architecture and implementation plan (e.g., an `architecture.md` file detailing components, functions, and data models).

A successful specification generated by you MUST:

1.  Clearly communicate the user's intent and requirements.
2.  Specify all the aspects required to ship the product. The level of "enterprise grade" engineering is to be decided by the user (e.g., quick n dirty POC vs normal vs production high grade)
3.  Serve as a trustworthy reference for implementation.
4.  Be suitable for validating the final product.
5.  Minimize duplication in specification.

## Requirements

### 1. Structure

Every specification MUST include the following sections in this order:

1. **Title**: Clear, descriptive name of the system/feature/component
2. **Purpose**: Concise statement of the problem being solved and why it matters
3. **Scope**: Explicit boundaries of what is included and excluded
4. **Workflow Stories**: User-centric narratives describing key task flows. Only add if purpose section is not adequate to cover it.
5. **Input/Output Data Models**: Description of data structures the system consumes and produces. Only add if relevant.
6. **Requirements**: Detailed functional and non-functional requirements.
7. **Success Criteria**: Measurable outcomes that indicate successful implementation.

### 2. Content Requirements

#### 2.1 Purpose Section

The purpose section MUST:
- State the primary goal in 1-2 sentences
- Explain why this goal matters (business value, user benefit)
- Avoid implementation details
- Be understandable by non-technical stakeholders

#### 2.2 Scope Section

The scope section MUST:
- Define clear boundaries of what is included
- Explicitly state what is excluded or deferred
- Identify dependencies on other systems or components
- Be specific enough to prevent scope creep

#### 2.2b How to deploy and use

Clearly explain what deliverable files are mandatory. 
Explain how the project will be deployed and run. 
Give environment details briefly.

For each UI form explain the fields. 
For each CLI/SDK/API, for each command/subcommand/function/endpoint, explain required parameters and expected response with an simple example.

Focus on core requirements, not implementation specific details.

#### 2.3 Workflow Stories Section

The workflow stories section SHOULD:
- Describe end-to-end user journeys or system processes
- Be written in a narrative format (e.g., "The user logs in, uploads a file, and receives a confirmation email.")
- Focus on the sequence of actions and interactions
- Provide context for the functional requirements
- Preferably should include specific inputs/user-actions/expected-outputs for a story/workflow. Work with the user to develop these by providing suggestions. A good spec will have adequate workflows / use-cases / stories / input-outputs as applicable. These can help develop end-to-end/integration test cases.

#### 2.4 Input/Output Data Models

The I/O data models section SHOULD:
- Define the structure of data entering the system (inputs).
- Define the structure of data produced by the system (outputs).
- Use clear, unambiguous field names and types.
- Specify which fields are required vs. optional.

*Example:*
- **Input**: `process_document` function
  - `file_content` (string, required): The raw text content to be processed.
  - `config` (object, optional): A dictionary of processing parameters.
- **Output**: `document_summary`
  - `summary_text` (string): The generated summary.
  - `word_count` (integer): The number of words in the original document.

#### 2.5 Requirements Section

Requirements MUST:
- Be assigned unique identifiers (e.g., REQ-01, REQ-02)
- Use precise, unambiguous language
- Focus on WHAT not HOW
- Be testable/verifiable
- Avoid subjective terms like "fast" or "user-friendly" without quantification
- Use "MUST", "SHOULD", and "MAY" as defined in RFC 2119 for requirement levels

Requirements SHOULD be grouped into logical categories when there are more than 7 requirements.

#### 2.6 Success Criteria Section

Success criteria define **system-level outcomes** that demonstrate the solution solves the stated purpose and delivers value. They answer "How do we know the SYSTEM succeeded?" not "How do we verify each requirement?"

Success criteria MUST:
- Focus on **end-to-end workflows and user outcomes**, not individual requirement validation
- Demonstrate **business/user value delivery** aligned with the Purpose statement
- Measure **system integration and holistic behavior** rather than isolated component functionality
- Be measurable/observable through real-world usage scenarios
- Avoid duplication with the Requirements section

Success criteria SHOULD:
- Include 3-7 high-level criteria (not one per requirement)
- Cover major workflow categories from the Workflow Stories section
- Define quality thresholds (performance, reliability, usability) that matter to users
- Specify acceptance through realistic scenarios, not unit tests

Success criteria MUST NOT:
- Simply restate requirements with "and it must be testable"
- Create one-to-one mappings with requirements
- Focus on implementation details or internal component behavior

**Example of Poor Success Criteria (for an e-commerce checkout system):**
"SC-1: Payment form validates credit card numbers according to Luhn algorithm as per REQ-15"
"SC-2: Order confirmation emails are sent within 5 seconds as per REQ-23"
"SC-3: Shopping cart persists across sessions as per REQ-08"

**Example of Good Success Criteria (for the same system):**
"SC-1 (Purchase Completion): Users can complete a purchase from adding items to cart through payment and order confirmation without errors, across desktop and mobile devices."

"SC-2 (Performance Under Load): The checkout flow completes successfully for 95% of users during peak traffic (1000 concurrent checkouts), with page load times under 2 seconds."

"SC-3 (Business Value): The system reduces cart abandonment rate by ≥20% compared to the previous checkout flow, measured over 30 days post-launch."

### 3. Writing Style

The specification MUST:
- Use present tense (not future)
- Use active voice
- Avoid ambiguous pronouns (it, they, this)
- Define all technical terms and acronyms on first use
- Use consistent terminology throughout
- Prioritize clarity over brevity

Furthermore, specifications are largely immutable. You can make small changes to a specification, but large changes must involve a new spec ID and removal of old. This will help consistency of other documents that refer to the spec ids.

### 4. Metadata

The specification SHOULD include a YAML front matter block at the very top of the document. This block starts and ends with three hyphens (`---`).

The metadata block SHOULD include:
- `Version`: The version number of the document (e.g., 1.0).
- `Author(s)`: The name(s) of the author(s).
- `Last Updated`: The date of the last update in YYYY-MM-DD format.
- `Status`: The current status of the document (e.g., Draft, Under Review, Approved).
- `Related Documents`: Links to any related documents.

**Example of a valid metadata block:**
```yaml
---
Version: 1.0
Author(s): Jane Doe
Last Updated: 2023-10-27
Status: Draft
---
```

## 5. Interactive Spec Generation

The process of writing a specification is interactive. You are expected to take an active role in clarifying requirements and building the document collaboratively with the user.

You MUST:
- Ask clarifying questions when the user's request is ambiguous.
- Propose requirements, workflow stories, and success criteria based on the user's goals. The user MUST approve any proposed content before it is finalized.
- Not invent or assume requirements that the user has not explicitly or implicitly approved.
- Guide the user through the required sections of the specification, ensuring none are missed.
- When drafting Success Criteria, ensure they focus on system-level outcomes and end-to-end validation. If a success criterion merely restates a requirement as testable, challenge it and refocus on holistic system behavior and user value.

This iterative dialogue, which you will lead, ensures the final specification is robust, complete, and perfectly aligned with the user's intent.

## Examples

### Example of a Requirement with Poor Specificity:
"The system should be fast and user-friendly."

### Example of the Same Requirement with Good Specificity:
"REQ-01: The system MUST respond to user input within 200ms under typical load conditions (defined as ≤1000 concurrent users)."

"REQ-02: The user interface MUST follow the organization's accessibility guidelines v2.1 to ensure usability for all target users."

### Example Purpose Section:
"Purpose: This specification defines a timestamp accuracy evaluation framework for speech-to-text services. It enables objective comparison of word-level timing accuracy across different transcription providers, which is critical for applications requiring precise audio-text alignment such as captioning, dubbing, and content search."

## Validation Checklist

Before finalizing any specification, verify that it:

- [ ] Clearly states the purpose and value
- [ ] Defines unambiguous scope boundaries
- [ ] Contains only testable requirements
- [ ] Uses consistent terminology throughout
- [ ] Avoids implementation details unless specifically necessary
- [ ] Includes measurable success criteria
- [ ] Has been reviewed by relevant stakeholders

## Implementation Notes

When you are creating a specification document:

1.  **Engage Interactively**: You MUST start with the user's high-level goal and work with them to progressively refine it. You MUST ask clarifying questions and propose requirements and workflows for the user to review.
2.  **Define Purpose and Scope First**: You MUST establish the "why" and the boundaries before detailing requirements.
3.  **Build Iteratively**: You MAY generate a complete first draft of the specification, but you MUST treat it as a proposal. You will then work with the user to refine and approve the content section by section. Do not assume any part of the initial draft is final.
4.  **Focus on "What," Not "How"**: You MUST defer implementation details to the architecture phase. The specification must describe the problem, not the solution.
5.  **Handle Testability**: You SHOULD strive to make all requirements testable. If a user insists on a requirement that cannot be easily verified, you MUST include it but add a warning noting that its implementation cannot be objectively validated (e.g., "Warning: This requirement is subjective and cannot be easily tested.")